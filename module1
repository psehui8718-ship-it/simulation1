import streamlit as st
import numpy as np
import plotly.graph_objects as go

def run():
    st.subheader("🔬 중성자 수송 해석 (Neutronics Simulation)")
    st.write("단순화된 모델을 통해 연료 농축도에 따른 임계도(k-effective)를 계산합니다.")

    enrichment = st.slider("연료 농축도 (U-235 wt%)", 1.0, 5.0, 3.0, 0.1)
    leakage_factor = st.slider("누설 계수", 0.01, 0.05, 0.03)

    k_eff = 0.9 + 0.05 * enrichment - 10 * leakage_factor

    st.metric(label="임계도 (k-effective)", value=f"{k_eff:.3f}")
    st.write("k-effective > 1.0 → 임계상태, k-effective < 1.0 → 비임계상태")

    x = np.linspace(0, 10, 100)
    flux = np.exp(-x * (1.1 - k_eff))  # 단순 감쇠 모델

    fig = go.Figure()
    fig.add_trace(go.Scatter(x=x, y=flux, mode='lines', name='중성자속'))
    fig.update_layout(title="중성자속 분포 (가상의 연료 셀)", xaxis_title="거리 (cm)", yaxis_title="상대 중성자속")
    st.plotly_chart(fig, use_container_width=True)
