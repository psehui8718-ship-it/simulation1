import streamlit as st
import numpy as np
import plotly.graph_objects as go

def run():
    st.subheader("ğŸ”¬ ì¤‘ì„±ì ìˆ˜ì†¡ í•´ì„ (Neutronics Simulation)")
    st.write("ë‹¨ìˆœí™”ëœ ëª¨ë¸ì„ í†µí•´ ì—°ë£Œ ë†ì¶•ë„ì— ë”°ë¥¸ ì„ê³„ë„(k-effective)ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.")

    enrichment = st.slider("ì—°ë£Œ ë†ì¶•ë„ (U-235 wt%)", 1.0, 5.0, 3.0, 0.1)
    leakage_factor = st.slider("ëˆ„ì„¤ ê³„ìˆ˜", 0.01, 0.05, 0.03)

    k_eff = 0.9 + 0.05 * enrichment - 10 * leakage_factor

    st.metric(label="ì„ê³„ë„ (k-effective)", value=f"{k_eff:.3f}")
    st.write("k-effective > 1.0 â†’ ì„ê³„ìƒíƒœ, k-effective < 1.0 â†’ ë¹„ì„ê³„ìƒíƒœ")

    x = np.linspace(0, 10, 100)
    flux = np.exp(-x * (1.1 - k_eff))  # ë‹¨ìˆœ ê°ì‡  ëª¨ë¸

    fig = go.Figure()
    fig.add_trace(go.Scatter(x=x, y=flux, mode='lines', name='ì¤‘ì„±ìì†'))
    fig.update_layout(title="ì¤‘ì„±ìì† ë¶„í¬ (ê°€ìƒì˜ ì—°ë£Œ ì…€)", xaxis_title="ê±°ë¦¬ (cm)", yaxis_title="ìƒëŒ€ ì¤‘ì„±ìì†")
    st.plotly_chart(fig, use_container_width=True)
